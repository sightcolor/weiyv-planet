# 最大子数组和

> **题目链接:** [LeetCode Link](https://leetcode.cn/problems/maximum-subarray/)

---

## 题目描述

> 给你一个整数数组 `nums` ，请你找出一个具有最大和的连续子数组（子数组最少包含一个元素），返回其最大和。
>
> **子数组** 是数组中的一个连续部分。
>
> **示例:**
> ```
> 输入: nums = [-2,1,-3,4,-1,2,1,-5,4]
> 输出: 6
> 解释: 连续子数组 [4,-1,2,1] 的和最大，为 6。
> ```

---

## 解题思路

### 核心思想
本解法采用**前缀和优化**的思路。我们知道，任意一个子数组 `[i, j]` 的和可以表示为 `前缀和[j] - 前缀和[i-1]`。

为了找到全局的最大子数组和，我们可以遍历数组，对于每一个位置 `j`，我们都尝试找到以 `nums[j]` **结尾**的子数组的最大和。以 `j` 结尾的最大子数组和，就等于 `前缀和[j]` 减去 `j` 之前出现过的**最小前缀和**（包括 0，代表从数组开头开始的子数组）。

通过一次遍历，我们可以同时计算当前的前缀和，并维护一个遇到的最小前缀和，从而实时更新全局最大子数组和。

### 算法步骤
1.  **初始化**:
    *   `sum = 0`: 用于记录当前的前缀和。
    *   `res = nums[0]`: 结果初始化为数组的第一个元素，以处理数组中全是负数的情况。
    *   `pre_min = 0`: 用于记录遍历过程中遇到的最小前缀和。初始化为 0 是关键，它代表了数组开始前的前缀和（空数组的和），使得第一个子数组（从索引 0 开始）也能被正确计算。
2.  **遍历数组**: 遍历 `nums` 数组中的每一个元素 `it`。
3.  **更新前缀和**: 将当前元素 `it` 累加到 `sum` 中 (`sum += it`)。
4.  **计算并更新最大和**: 当前位置的最大子数组和等于 `sum - pre_min`。我们用这个值来更新全局最大和 `res`，即 `res = max(res, sum - pre_min)`。
5.  **更新最小前缀和**: 在更新完 `res` 之后，用当前的 `sum` 来更新 `pre_min`，即 `pre_min = min(pre_min, sum)`，以便在下一轮循环中使用。
6.  **返回**: 遍历结束后，`res` 就是全局的最大子数组和。

### 复杂度分析
- **时间复杂度**: O(N)
  *我们只需要对数组进行一次线性遍历。*
- **空间复杂度**: O(1)
  *只使用了 `sum`, `res`, `pre_min` 等几个变量，占用了常数级别的额外空间。*

---

## 代码实现

```cpp
#include <vector>
#include <algorithm> // for std::max and std::min
#include <limits>    // for std::numeric_limits

class Solution {
public:
    int maxSubArray(std::vector<int>& nums) {
        int n = nums.size();
        // sum: 当前的前缀和
        int sum = 0;
        // res: 全局最大子数组和，初始化为第一个元素以应对全负数情况
        int res = nums;
        // pre_min: 遍历过程中遇到的最小前缀和，初始化为0
        // (代表空数组的前缀和，即数组开始前的位置)
        int pre_min = 0;

        for(int& it : nums) {
            // 1. 更新当前的前缀和
            sum += it;
            
            // 2. 计算以当前元素结尾的最大子数组和 (sum - pre_min)
            //    并用它来更新全局最大和 res
            res = std::max(res, sum - pre_min);
            
            // 3. 更新到目前为止遇到的最小前缀和，供下一轮计算使用
            pre_min = std::min(pre_min, sum);
        }
        
        return res;
    }
};
```